{
  "variables": {
    "aws_access_key": "AKIAJGTB6C6XHWJ7FDZA",
    "aws_secret_key": "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",
    "subnet_id": "subnet-095da6e17b8a374ee",
    "vpc_id": "vpc-0a3ee34400021a65e"
  },

  "builders": [
    {
      "name": "xbs-builder-name",
      "access_key": "{{user `aws_access_key`}}",
      "secret_key": "{{user `aws_secret_key`}}",
      "type": "amazon-ebs",
      "ami_name": "xbs-autogenerated-ami-1240",
      "instance_type": "t2.micro",
      "region": "eu-central-1",
      "source_ami_filter": {
        "filters": {
          "virtualization-type": "hvm",
          "name": "xbs-manual-ami-image"
        },
        "owners": ["491792459462"],
        "most_recent": true
      },

      "ami_regions": [
        "eu-central-1"
      ],
      "launch_block_device_mappings": [
        {
          "delete_on_termination": true,
          "device_name": "/dev/sda1",
          "volume_size": 10,
          "volume_type": "gp2"
        }
      ],
      "run_tags": {
        "Name": "packer-temp-builder",
        "component": "xbs-dev",
        "managed_by": "pse",
        "service": "platform-xbs-dev",
        "service_identifier": "xbs-dev-v1.0",
        "stack": "ami"
      },
      "run_volume_tags": {
        "Name": "packer-temp-builder",
        "component": "xbs-dev",
        "managed_by": "pse",
        "service": "platform-xbs-dev",
        "service_identifier": "xbs-dev-v1.0",
        "stack": "ami"
      },
      "snapshot_tags": {
        "Name": "xbs-auto-v1.0",
        "build_region": "eu-central-1",
        "component": "xbs-dev",
        "managed_by": "pse",
        "service": "platform-xbs-dev",
        "service_identifier": "xbs-dev-v1.0",
        "source_ami": "{{ .SourceAMI }}",
        "stack": "ami",
        "version": "xbs1.0"
      },
      "ssh_pty": "true",
      "ssh_username": "ec2-user",
      "subnet_id": "{{user `subnet_id`}}",
      "tags": {
        "Name": "xbs-autogenerated-ami",
        "build_region": "eu-central-1",
        "component": "xbs-dev"
      },
      "vpc_id": "{{user `vpc_id`}}"
    }
  ],

  "provisioners": [
    {
    "type": "shell",
    "script": "xbs_script.sh"
    }
    ]

}
